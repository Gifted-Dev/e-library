<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/static/css/style.css">

</head>
    <body class="d-flex flex-column">
        
    <nav class="navbar navbar-expand-md navbar-dark py-4 shadow-sm">
        <div class="container-fluid mx-lg-5">
            <!-- Navbar Items -->

            <a href="/" class="navbar-brand d-flex align-items-center">
                <img src="/static/img/LIGHTBEARER.png" alt="logo" width="30" height="30" class="d-inline-block">
                <span class="fw-bold">Lightbearers</span> 
            </a>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-lg-0 mb-2">
                    <li class="nav-item"><a href="/" class="nav-link active">Home</a></li>
                    <li class="nav-item"><a href="/books" class="nav-link">Books</a></li>
                </ul>
            </div>

            <!-- Right side buttons & mobile toggler -->
            <div class="d-flex align-items-center">
                <div class="d-none d-md-flex align-items-center">
                    {% if current_user %}
                        <div class="dropdown">
                            <a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-person-circle fs-4 me-2"></i>
                                <span>{{ current_user.first_name }}</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-dark dropdown-menu-end text-small shadow">
                                <li><a class="dropdown-item" href="/profile">My Profile</a></li>
                                {% if current_user.role in ['admin', 'superadmin'] %}
                                <li><a class="dropdown-item" href="/admin/upload-book">Upload Book</a></li>
                                <li><a class="dropdown-item" href="/admin">Admin Dashboard</a></li>
                                {% endif %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="#" hx-post="/api/v1/auth/logout" hx-confirm="Are you sure you want to log out?">Logout</a></li>
                            </ul>
                        </div>
                    {% else %}
                        <button
                            class="btn btn-primary me-2"
                            data-bs-toggle="modal"
                            data-bs-target="#loginModal"
                        >
                            Login
                        </button>
                        <a href="/signup" class="btn btn-outline-light">Sign Up</a>
                    {% endif %}
                </div>

                <!-- Hamburger Menu Button (visible on mobile) -->
                <button class="navbar-toggler d-md-none ms-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu (Offcanvas) -->
    <div class="offcanvas offcanvas-end text-bg-dark d-md-none" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenuLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="mobileMenuLabel">Menu</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="/books">Books</a></li>
                <hr>
                {% if current_user %}
                    <li class="nav-item"><a class="nav-link" href="/profile">My Profile</a></li>
                    {% if current_user.role in ['admin', 'superadmin'] %}
                    <li class="nav-item"><a class="nav-link" href="/admin/upload-book">Upload Book</a></li>
                    <li class="nav-item"><a class="nav-link" href="/admin">Admin Dashboard</a></li>
                    {% endif %}
                    <li class="nav-item"><a class="nav-link" href="#" hx-post="/api/v1/auth/logout" hx-confirm="Are you sure you want to log out?">Logout</a></li>
                {% else %}
                    <li class="nav-item"><a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="offcanvas">Login</a></li>
                    <li class="nav-item"><a class="nav-link" href="/signup">Sign Up</a></li>
                {% endif %}
            </ul>
        </div>
    </div>

    <main class="flex-grow-1 d-flex">
        {% block content %}
        <!-- Content injected by child templates -->
        {% endblock %}
    </main>

    <footer>
        {% block footer %}
        {% endblock %}
    </footer>

        <!-- Login Modal (simplified for example) -->
    <div
        class="modal fade"
        id="loginModal"
        tabindex="-1"
        aria-labelledby="loginModalLabel"
        aria-hidden="true"
    >
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login</h5>
                    <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                    >
                    </button>
                </div>

                <div class="modal-body">
                    <div id="login-alert-container" class="mb-3"></div>
                    <!-- Login form fields here -->
                    <form
                        hx-post="/api/v1/auth/login"
                        hx-target="#login-alert-container"
                        hx-swap="innerHTML"
                    >
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email address</label>
                            <input
                                type="email"
                                class="form-control"
                                id="loginEmail"
                                name="loginEmail"
                                placeholder="name@example.com"
                            />
                        </div>

                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" name="loginPassword" />
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Log in</button>
                    </form>
                    <div class="text-center mt-3">
                        <a href="/forgot-password" class="link-themed">Forgot Password?</a>
                    </div>
                    <hr>
                    <div class="text-center">
                        <span>Don't have an account? </span><a href="/signup" class="link-themed">Sign Up</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/htmx.org@1.9.12" integrity="sha384-ujb1lZYygJmzgSwoxRggbCHcjc0rB2XoQrxeTUQyRjrOnlCoYta87iKBWq3EsdM2" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.min.js" integrity="sha384-7qAoOXltbVP82dhxHAUje59V5r2YsVfBafyUDxEdApLPmcdhBPg1DKg1ERo0BZlK" crossorigin="anonymous"></script>

    </body>
</html>